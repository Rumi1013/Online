{%- comment -%}
  Blog template for article listings
{%- endcomment -%}

<div class="blog-page">
  <div class="container">
    <div class="blog-header animate-fade-in">
      <h1 class="blog-title">{{ blog.title }}</h1>
      {%- if blog.description != blank -%}
        <p class="blog-description">{{ blog.description }}</p>
      {%- endif -%}
    </div>

    <div class="blog-content">
      {%- if blog.articles.size > 0 -%}
        <div class="articles-grid">
          {%- for article in blog.articles -%}
            <article class="article-card animate-fade-in-up" style="animation-delay: {{ forloop.index | times: 0.1 }}s;">
              {%- if article.image -%}
                <div class="article-image">
                  <a href="{{ article.url }}">
                    <img 
                      src="{{ article.image | image_url: width: 400 }}"
                      alt="{{ article.image.alt | default: article.title | escape }}"
                      loading="lazy"
                    >
                  </a>
                </div>
              {%- endif -%}

              <div class="article-content">
                <div class="article-meta">
                  <time class="article-date" datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
                    {{ article.published_at | date: '%B %d, %Y' }}
                  </time>
                  {%- if article.tags.size > 0 -%}
                    <div class="article-tags">
                      {%- for tag in article.tags limit: 3 -%}
                        <span class="article-tag">{{ tag }}</span>
                      {%- endfor -%}
                    </div>
                  {%- endif -%}
                </div>

                <h2 class="article-title">
                  <a href="{{ article.url }}">{{ article.title }}</a>
                </h2>

                <div class="article-excerpt">
                  {{ article.excerpt | default: article.content | strip_html | truncate: 150 }}
                </div>

                <div class="article-footer">
                  <a href="{{ article.url }}" class="btn btn--secondary article-read-more">
                    {{ 'blogs.article.read_more' | t }}
                  </a>
                  
                  {%- if blog.moderated? == false -%}
                    <a href="{{ article.url }}#comments" class="article-comments-link">
                      {{ 'blogs.article.comments' | t: count: article.comments_count }}
                    </a>
                  {%- endif -%}
                </div>
              </div>
            </article>
          {%- endfor -%}
        </div>

        {%- comment -%} Pagination {%- endcomment -%}
        {%- if paginate.pages > 1 -%}
          <nav class="pagination" role="navigation" aria-label="Blog Pagination">
            {%- if paginate.previous -%}
              <a href="{{ paginate.previous.url }}" class="pagination__item pagination__item--prev">
                ← {{ 'general.pagination.previous' | t }}
              </a>
            {%- endif -%}

            {%- for part in paginate.parts -%}
              {%- if part.is_link -%}
                <a href="{{ part.url }}" class="pagination__item">{{ part.title }}</a>
              {%- else -%}
                {%- if part.title == paginate.current_page -%}
                  <span class="pagination__item pagination__item--current">{{ part.title }}</span>
                {%- else -%}
                  <span class="pagination__item">{{ part.title }}</span>
                {%- endif -%}
              {%- endif -%}
            {%- endfor -%}

            {%- if paginate.next -%}
              <a href="{{ paginate.next.url }}" class="pagination__item pagination__item--next">
                {{ 'general.pagination.next' | t }} →
              </a>
            {%- endif -%}
          </nav>
        {%- endif -%}
      {%- else -%}
        <div class="blog-empty">
          <h2>No articles yet</h2>
          <p>Stay tuned for mystical insights and sacred wisdom.</p>
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

{%- paginate blog.articles by 9 -%}
  {%- comment -%} Pagination handled above {%- endcomment -%}
{%- endpaginate -%}